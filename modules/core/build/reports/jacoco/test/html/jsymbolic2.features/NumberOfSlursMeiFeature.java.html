<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ru"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>NumberOfSlursMeiFeature.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jsymbolic-core</a> &gt; <a href="index.source.html" class="el_package">jsymbolic2.features</a> &gt; <span class="el_source">NumberOfSlursMeiFeature.java</span></div><h1>NumberOfSlursMeiFeature.java</h1><pre class="source lang-java linenums">package jsymbolic2.features;

import javax.sound.midi.Sequence;
import ace.datatypes.FeatureDefinition;
import jsymbolic2.featureutils.MEIFeatureExtractor;
import jsymbolic2.processing.MIDIIntermediateRepresentations;
import org.ddmal.jmei2midi.meielements.meispecific.MeiSpecificStorage;

/**
 * A feature calculator that The total number of notes marked with slurs in the piece (i.e. the number of
 * notes indicated as notes with slurs in the MEI encoding) divided by the total number of pitched notes in 
 * the music.
 *
 * &lt;p&gt;Since this is an MEI-specific feature, the feature information is obtained from the
 * {@link MeiSpecificStorage} class. The associated code can be found
 * &lt;a href=&quot;https://github.com/DDMAL/jMei2Midi&quot;&gt;jMei2Midi&lt;/a&gt;, which is included as a dependency of
 * jSymbolic.&lt;/p&gt;
 *
 * @author Tristano Tenaglia and Cory McKay
 */
public class NumberOfSlursMeiFeature extends MEIFeatureExtractor
{
	/* CONSTRUCTOR ******************************************************************************************/

	
	/**
	 * Basic constructor that sets the values of the fields inherited from this class' superclass.
	 */
	public NumberOfSlursMeiFeature()
<span class="fc" id="L30">	{</span>
<span class="fc" id="L31">		code = &quot;S-2&quot;;</span>
<span class="fc" id="L32">		name = &quot;Number of Slurs&quot;;</span>
<span class="fc" id="L33">		description = &quot;The total number of notes marked with slurs in the piece (i.e. the number of notes indicated as notes with slurs in the MEI encoding) divided by the total number of pitched notes in the music.&quot;;</span>

<span class="fc" id="L35">	}</span>
	

	/* PUBLIC METHODS ***************************************************************************************/
	
	
	/**
	 * The prototype method that classes extending this class will override in order to extract their
	 * feature from a section of MEI data (and the associated MIDI data generated from it).
	 *
	 * @param meiSpecificStorage	Holds all accessible MEI-specific data from which to extract this feature.
	 * @param sequence				The MIDI data generated from the MEI data, and which can abe used to help
	 *								extract this feature. Notice that this can be taken directly from the 
	 *								{@link org.ddmal.jmei2midi.MeiSequence}.
	 * @param sequence_info			Additional data already extracted from the the MIDI sequence.
	 * @param other_feature_values	The values of other features that are needed to calculate this value. The
	 *								order and offsets of these features must be the same as those returned by 
	 *								this class's getDependencies and getDependencyOffsets methods
	 *								respectively.The first indice indicates the feature/window and the second
	 *								indicates the value.
	 * @return						The extracted feature value(s).
	 * @throws Exception			Throws an informative exception if the feature cannot be calculated.
	 */
	@Override
	public double[] extractMEIFeature( MeiSpecificStorage meiSpecificStorage,
									   Sequence sequence,
									   MIDIIntermediateRepresentations sequence_info,
									   double[][] other_feature_values )
	throws Exception
	{
		double value;
<span class="pc bpc" id="L66" title="1 of 2 branches missed.">		if (sequence_info != null)</span>
		{
<span class="fc" id="L68">			double total_number_pitched_note_ons = (double) sequence_info.total_number_pitched_note_ons;</span>
<span class="fc" id="L69">			double number_of_slur_notes = (double) meiSpecificStorage.getSlurNoteList().size();</span>

<span class="pc bpc" id="L71" title="2 of 4 branches missed.">			if (total_number_pitched_note_ons == 0.0 || number_of_slur_notes == 0.0)</span>
<span class="nc" id="L72">				value = 0.0;</span>
			else
<span class="fc" id="L74">				value = number_of_slur_notes / total_number_pitched_note_ons;</span>
<span class="fc" id="L75">		}</span>
<span class="nc" id="L76">		else value = -1.0;</span>

<span class="fc" id="L78">		double[] result = new double[1];</span>
<span class="fc" id="L79">		result[0] = value;</span>
<span class="fc" id="L80">		return result;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>