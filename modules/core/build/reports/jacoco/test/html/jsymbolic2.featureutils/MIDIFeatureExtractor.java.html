<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ru"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MIDIFeatureExtractor.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jsymbolic-core</a> &gt; <a href="index.source.html" class="el_package">jsymbolic2.featureutils</a> &gt; <span class="el_source">MIDIFeatureExtractor.java</span></div><h1>MIDIFeatureExtractor.java</h1><pre class="source lang-java linenums">package jsymbolic2.featureutils;

import ace.datatypes.FeatureDefinition;
import java.util.Objects;
import jsymbolic2.processing.MIDIIntermediateRepresentations;

import javax.sound.midi.Sequence;

/**
 * The prototype class for features designed to extract features from MIDI data. Each class that extends this
 * class will extract a particular feature from some sequence of MIDI data. Such classes do not store feature
 * values, only extract them. Classes that extend this class should have a constructor that sets the four
 * protected fields of this class.
 *
 * @author Cory McKay
 */
<span class="fc" id="L17">public abstract class MIDIFeatureExtractor {</span>
    /* FIELDS ***********************************************************************************************/


    /**
     * The unique code identifying a feature that extends this class (see the HTML manual for identifying
     * codes). Should be one or more letters identifying the feature group the feature belongs to, followed
     * by a hyphen, followed by the number of the feature within that group. For example, a value of I-7
     * would be appropriate for the seventh feature of the Instrumentation feature group.
     */
    protected String code;

    /**
     * Meta-data about a feature that extends this class. Includes the feature's unique name; a description
     * of what information the feature represents and how it is calculated; whether the feature can be
     * extracted from sequential windows of data; and its dimensions (the number of values an extracted
     * feature will consist of). Note that a value of 0 in the returned dimensions of the FeatureDefinition
     * implies that the feature dimensions are variable, and depend on the analyzed data.
     */
    protected FeatureDefinition definition;

    /**
     * The names of other features that are needed in order for a feature to be calculated. Will be null if
     * a feature does not depend on any other features.
     */
    protected String[] dependencies;

    /**
     * The offset in windows of each of the features named in the dependencies field. An offset of -1, for
     * example, means that the feature in dependencies with the same index value should be provided to this
     * class' extractFeature method with a value that corresponds to the window prior to the window
     * corresponding to this feature. Will be null if there are no dependencies. This must be null, 0 or a
     * negative number. Positive numbers are not allowed.
     */
    protected int[] offsets;
    protected String name;
    protected String description;
<span class="fc" id="L54">    protected boolean isSequentional = true;</span>
<span class="fc" id="L55">    protected int dimensions = 1;</span>


    /* PUBLIC METHODS ***************************************************************************************/



    /**
     * Returns meta-data about a feature that extends this class. Includes the feature's unique name; a
     * description of what information the feature represents and how it is calculated; whether the feature
     * can be extracted from sequential windows of data; and its dimensions (the number of values an extracted
     * feature will consist of). Note that a value of 0 in the returned dimensions of the FeatureDefinition
     * implies that the feature dimensions are variable, and depend on the analyzed data.
     *
     * @return The definition of this particular feature.
     */
    public FeatureDefinition getFeatureDefinition() {
<span class="fc" id="L72">        return new FeatureDefinition(getName(), getDescription(), isSequentional(), getDimensions());</span>
    }


    /**
     * Returns the names of other features that are needed in order to extract this feature. Will return null
     * if no other features are needed.
     *
     * @return The dependencies of this particular feature.
     */
    public String[] getDepenedencies() {
<span class="fc" id="L83">        return dependencies;</span>
    }


    /**
     * Returns the offsets of other features that are needed in order to extract this feature. Will return
     * null if no other features are needed.
     *
     * &lt;p&gt;The offset is in windows, and the indice of the retuned array corresponds to the indice of the array
     * returned by the getDependencies method. An offset of -1, for example, means that the feature returned
     * by getDependencies with the same indice should be provided to this class's extractFeature method with a
     * value that corresponds to the window prior to the window corresponding to this feature.&lt;/p&gt;
     *
     * @return The dependency offsets of this particular feature.
     */
    public int[] getDepenedencyOffsets() {
<span class="fc" id="L99">        return offsets;</span>
    }


    /**
     * The prototype method that classes extending this class will override in order to extract their
     * feature from a sequence of MIDI data.
     *
     * @param sequence             The MIDI data to extract the feature from.
     * @param sequence_info        Additional data already extracted from the the MIDI sequence.
     * @param other_feature_values The values of other features that may be needed to calculate this feature.
     *                             The order and offsets of these features must be the same as those returned
     *                             by this class' getDependencies and getDependencyOffsets methods,
     *                             respectively. The first indice indicates the feature/window, and the
     *                             second indicates the value.
     * @throws Exception Throws an informative exception if the feature cannot be calculated.
     * @return The extracted feature value(s).
     */
    public abstract double[] extractFeature(Sequence sequence,
                                            MIDIIntermediateRepresentations sequence_info,
                                            double[][] other_feature_values)
            throws Exception;

    public String getName() {
<span class="fc" id="L123">        return name;</span>
    }

    public String getDescription() {
<span class="fc" id="L127">        return description;</span>
    }

    public boolean isSequentional() {
<span class="fc" id="L131">        return isSequentional;</span>
    }

    public int getDimensions() {
<span class="fc" id="L135">        return dimensions;</span>
    }

    public String getCode() {
<span class="fc" id="L139">        return code;</span>
    }

    @Override
    public String toString() {
<span class="nc" id="L144">        return getFeatureDefinition().getFeatureDescription();</span>
    }

    @Override
    public boolean equals(Object obj) {
<span class="nc bnc" id="L149" title="All 2 branches missed.">        if (obj instanceof MIDIFeatureExtractor midiFeatureExtractor) {</span>
<span class="nc" id="L150">            return Objects.equals(getCode(), midiFeatureExtractor.getCode());</span>
        }
<span class="nc" id="L152">        return false;</span>
    }

    @Override
    public int hashCode() {
<span class="nc" id="L157">        return Objects.hashCode(getCode());</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>