<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ru"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>FeaturesSaver.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jsymbolic-core</a> &gt; <a href="index.source.html" class="el_package">jsymbolic2.processing</a> &gt; <span class="el_source">FeaturesSaver.java</span></div><h1>FeaturesSaver.java</h1><pre class="source lang-java linenums">package jsymbolic2.processing;

import ace.datatypes.DataBoard;

import java.io.File;
import java.io.PrintStream;

/**
 * This class is used to save extracted features to files. Extracted features are passed in DataBoard
 */
<span class="fc" id="L11">public enum FeaturesSaver {</span>
    ;

    /**
     * Validates filepath to write and writes into CSV file
     *
     * @param dataBoard DataBoard with information about features to save
     * @param filePath  Path to save the info
     * @throws RuntimeException Throws an informative
     *                          Runtime exception if it cannot write into file.
     */
    static void SaveCSV(DataBoard dataBoard, String filePath, PrintStream status_print_stream)
            throws RuntimeException {
<span class="nc" id="L24">        File file = new File(FeaturesSaver.addExtension(filePath, &quot;csv&quot;));</span>
<span class="nc" id="L25">        FeaturesSaver.validateFile(file);</span>
        try {
<span class="nc" id="L27">            UserFeedbackGenerator.printGeneratingCsvFile(status_print_stream, file.getPath());</span>
<span class="nc" id="L28">            dataBoard.saveToCSV(file, true,</span>
                    true, true,
                    true, true);
<span class="nc" id="L31">        } catch (Exception e) {</span>
<span class="nc" id="L32">            throw new RuntimeException(&quot;Could not write CSV into &quot; + filePath);</span>
<span class="nc" id="L33">        }</span>
<span class="nc" id="L34">    }</span>

    /**
     * Validates filepath to write and writes into ARFF file
     *
     * @param dataBoard DataBoard with information about features to save
     * @param filePath  Path to save the info
     * @throws RuntimeException Throws an informative
     *                          Runtime exception if it cannot write into file.
     */
    static void SaveARFF(DataBoard dataBoard, String filePath,
                         PrintStream status_print_stream) throws RuntimeException {
<span class="nc" id="L46">        File file = new File(FeaturesSaver.addExtension(filePath, &quot;arff&quot;));</span>
<span class="nc" id="L47">        FeaturesSaver.validateFile(file);</span>
        try {
<span class="nc" id="L49">            UserFeedbackGenerator.printGeneratingArffFile(status_print_stream, file.getPath());</span>
<span class="nc" id="L50">            dataBoard.saveToARFF(&quot;Music&quot;, file,</span>
                    true, true);
<span class="nc" id="L52">        } catch (Exception e) {</span>
<span class="nc" id="L53">            throw new RuntimeException(&quot;Could not write CSV into &quot; + filePath);</span>
<span class="nc" id="L54">        }</span>
<span class="nc" id="L55">    }</span>

    /**
     * Validates filepath to write and writes into ARFF file
     *
     * @param dataBoard           DataBoard with information about features to save
     * @param filePathDefinitions Path to save descriptions of features. May be null
     * @param filePathValues      Path to save values of features
     * @throws RuntimeException Throws an informative
     *                          Runtime exception if it cannot write into file.
     */
    static void SaveXML(DataBoard dataBoard, String filePathDefinitions, String filePathValues,
                        PrintStream status_print_stream) throws RuntimeException {
<span class="fc" id="L68">        File fileDefinitions = null;</span>
<span class="pc bpc" id="L69" title="1 of 2 branches missed.">        if (null != filePathDefinitions) {</span>
<span class="fc" id="L70">            fileDefinitions = new File(FeaturesSaver.addExtension(filePathDefinitions, &quot;xml&quot;));</span>
<span class="fc" id="L71">            FeaturesSaver.validateFile(fileDefinitions);</span>
        }
<span class="fc" id="L73">        File fileValues = new File(FeaturesSaver.addExtension(filePathValues, &quot;xml&quot;));</span>
<span class="fc" id="L74">        FeaturesSaver.validateFile(fileValues);</span>
        try {
<span class="fc" id="L76">            UserFeedbackGenerator.printGeneratingAceXmlFeatureDefinitionsFile(status_print_stream, fileValues.getPath());</span>
<span class="fc" id="L77">            UserFeedbackGenerator.printGeneratingAceXmlFeatureValuesFile(status_print_stream, fileValues.getPath());</span>
<span class="fc" id="L78">            dataBoard.saveXMLFiles(null, fileDefinitions,</span>
                    fileValues, null);
<span class="nc" id="L80">        } catch (Exception e) {</span>
<span class="nc" id="L81">            throw new RuntimeException(&quot;Cannot not write XML: &quot; + e + &quot; &quot; + e.getMessage());</span>
<span class="fc" id="L82">        }</span>
<span class="fc" id="L83">    }</span>


    /**
     * Checks filepath and add extension to string
     *
     * @param filePath  Filepath to check
     * @param extension Extension to add
     * @return Filepath with required extension
     */
    private static String addExtension(String filePath, String extension) {
<span class="pc bpc" id="L94" title="1 of 2 branches missed.">        if (filePath.endsWith(&quot;.&quot; + extension)) {</span>
<span class="fc" id="L95">            return filePath;</span>
        }
<span class="nc" id="L97">        StringBuilder dirBuilder = new StringBuilder(filePath);</span>
<span class="nc" id="L98">        StringBuilder nameBuilder = new StringBuilder(filePath);</span>
<span class="nc" id="L99">        int nameIndex = dirBuilder.lastIndexOf(&quot;/&quot;);</span>
<span class="nc" id="L100">        nameBuilder.delete(0, nameIndex + 1);</span>
<span class="nc" id="L101">        dirBuilder.delete(nameIndex + 1, filePath.length());</span>
<span class="nc bnc" id="L102" title="All 2 branches missed.">        if (nameBuilder.toString().contains(&quot;.&quot;)) {</span>
<span class="nc" id="L103">            int dotIndex = nameBuilder.toString().indexOf('.');</span>
<span class="nc" id="L104">            nameBuilder.delete(dotIndex, nameBuilder.length());</span>
<span class="nc" id="L105">            nameBuilder.append(&quot;.&quot;).append(extension);</span>
        }
<span class="nc" id="L107">        return dirBuilder.append(nameBuilder).toString();</span>
    }

    /**
     * Checks file existence and rights to write
     *
     * @param file File to check
     * @throws IllegalArgumentException Throws exception if file does not exist
     *                                  or has no write access
     */
    private static void validateFile(File file) {
<span class="pc bpc" id="L118" title="2 of 4 branches missed.">        if (file.exists() &amp;&amp; !file.canWrite()) {</span>
<span class="nc" id="L119">            throw new IllegalArgumentException(&quot;Cannot write to &quot; + file.getPath() + &quot;.&quot;);</span>
        }
<span class="fc" id="L121">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>